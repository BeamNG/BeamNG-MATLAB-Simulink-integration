<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2023b"><title>Lidar tour</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S2 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S3 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { color: rgb(33, 33, 33); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 17.234px;  }
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsErrorElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsErrorElement .diagnosticMessage-errorType {    overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
/* Styling that is common to warnings and errors is in diagnosticOutput.css */.embeddedOutputsWarningElement {    min-height: 18px;    max-height: 550px;}
.embeddedOutputsWarningElement .diagnosticMessage-warningType {    overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
/* Copyright 2015-2023 The MathWorks, Inc. *//* In this file, styles are not scoped to rtcContainer since they could be in the Dojo Tooltip */.diagnosticMessage-wrapper {    font-family: Menlo, Monaco, Consolas, "Courier New", monospace;    font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {    /*This fallback value will be used for appdesigner warnings*/    color: var(--rtc-warning-output-color, var(--mw-color-matlabWarning));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-warningType a {    color: var(--mw-color-matlabWarning) !important;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {    /*This fallback value will be used in appdesigner error tooltip text*/    color: var(--rtc-error-output-color, var(--mw-color-matlabErrors));    text-decoration: underline;}
.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType,.rtcThemeDefaultOverride .diagnosticMessage-wrapper.diagnosticMessage-errorType a {    color: var(--mw-color-matlabErrors) !important;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {    white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {    white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {    white-space: pre;    word-wrap:  initial;    min-height: 18px;    max-height: 550px;}
.embeddedOutputsTextElement .textElement,.embeddedOutputsVariableStringElement .textElement {    overflow: auto;}
.textElement,.rtcDataTipElement .textElement {    padding-top: 2px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {    min-height: 16px;}
.rightPaneElement .textElement {    padding-top: 2px;    padding-left: 9px;}
.S6 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 1px solid rgb(217, 217, 217); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(217, 217, 217); border-right: 1px solid rgb(217, 217, 217); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(217, 217, 217); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Lidar tour</span></h1><h2  class = 'S1'><span>Scenario setup</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% link bng object to BeamNG folder </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng = py.beamngpy.BeamNGpy(</span><span style="color: #a709f5;">'localhost'</span><span >, int32(25252)); </span><span style="color: #008013;">%if you set the BNG_HOME in your Environment Variables</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% beamng = BeamNGpy('localhost', 25252, home='/path/to/bng/tech', user='/path/to/bng/tech/userfolder')</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% beamng.open(listen_ip='*');  % Start up the simulator in default renderer i.e., Vulkan.</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.open(py.list({string(missing),</span><span style="color: #a709f5;">'Value'</span><span >}), </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre"><span >    </span><span style="color: #a709f5;">'-gfx'</span><span >, </span><span style="color: #a709f5;">'dx11'</span><span >, listen_ip=</span><span style="color: #a709f5;">'*'</span><span >) </span><span style="color: #008013;">% Start up the simulator in DirectX 11 Renderer .</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper disableDefaultGestureHandling embeddedOutputsVariableStringElement scrollableOutput" uid="09F0A74D" prevent-scroll="true" data-testid="output_0" tabindex="-1" style="width: 1146px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div class="textElement eoOutputContent scrollArea" tabindex="-1" data-previous-available-width="1109" data-previous-scroll-height="1363" data-hashorizontaloverflow="false" style="max-height: 261px; white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;"><span class="variableNameElement" style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">ans = </span></div><div style="white-space: pre; font-style: normal; color: rgb(33, 33, 33); font-size: 12px;">  Python BeamNGpy with properties:

                     scenario: [1×1 py.beamngpy.api.beamng.scenario.ScenarioApi]
                   connection: [1×1 py.beamngpy.connection.connection.Connection]
                  set_gravity: [1×1 py.method]
                     show_hud: [1×1 py.method]
                         port: [1×1 py.int]
                          env: [1×1 py.beamngpy.api.beamng.environment.EnvironmentApi]
    get_current_vehicles_info: [1×1 py.method]
      load_trackbuilder_track: [1×1 py.method]
          set_relative_camera: [1×1 py.method]
                start_traffic: [1×1 py.method]
          add_debug_rectangle: [1×1 py.method]
                         step: [1×1 py.method]
           set_weather_preset: [1×1 py.method]
         remove_debug_spheres: [1×1 py.method]
                         user: [1×1 py.NoneType]
          get_part_annotation: [1×1 py.method]
         set_steps_per_second: [1×1 py.method]
                           ui: [1×1 py.beamngpy.api.beamng.ui.UiApi]
            remove_debug_text: [1×1 py.method]
           add_debug_polyline: [1×1 py.method]
                  quit_beamng: [1×1 py.method]
        remove_debug_triangle: [1×1 py.method]
             teleport_vehicle: [1×1 py.method]
                     settings: [1×1 py.beamngpy.api.beamng.settings.SettingsApi]
     teleport_scenario_object: [1×1 py.method]
                quit_on_close: 1
                       binary: [1×1 py.NoneType]
       set_player_camera_mode: [1×1 py.method]
        remove_debug_polyline: [1×1 py.method]
       get_annotation_classes: [1×1 py.method]
                get_gamestate: [1×1 py.method]
               get_road_edges: [1×1 py.method]
            get_scenario_name: [1×1 py.method]
         set_nondeterministic: [1×1 py.method]
           crash_lua_on_error: [1×1 py.NoneType]
                spawn_traffic: [1×1 py.method]
        remove_debug_cylinder: [1×1 py.method]
                      control: [1×1 py.beamngpy.api.beamng.control.ControlApi]
        set_particles_enabled: [1×1 py.method]
              set_free_camera: [1×1 py.method]
       add_debug_square_prism: [1×1 py.method]
     get_levels_and_scenarios: [1×1 py.method]
           add_debug_triangle: [1×1 py.method]
                       resume: [1×1 py.method]
                      process: [1×1 py.subprocess.Popen]
                         host: [1×9 py.str]
                        debug: [1×1 py.beamngpy.api.beamng.debug.DebugApi]
          await_vehicle_spawn: [1×1 py.method]
            queue_lua_command: [1×1 py.method]
               switch_vehicle: [1×1 py.method]
       apply_graphics_setting: [1×1 py.method]
               start_scenario: [1×1 py.method]
                     hide_hud: [1×1 py.method]
                       logger: [1×1 py.logging.Logger]
    remove_debug_square_prism: [1×1 py.method]
       remove_debug_rectangle: [1×1 py.method]
                      traffic: [1×1 py.beamngpy.api.beamng.traffic.TrafficApi]
                get_scenarios: [1×1 py.method]
                       camera: [1×1 py.beamngpy.api.beamng.camera.CameraApi]
         get_current_vehicles: [1×1 py.method]
              despawn_vehicle: [1×1 py.method]
                 stop_traffic: [1×1 py.method]
                       system: [1×1 py.beamngpy.api.beamng.system.SystemApi]
                load_scenario: [1×1 py.method]
                         home: [1×1 py.NoneType]
       get_available_vehicles: [1×1 py.method]
          get_level_scenarios: [1×1 py.method]
                        pause: [1×1 py.method]
                stop_scenario: [1×1 py.method]
      get_player_camera_modes: [1×1 py.method]
            add_debug_spheres: [1×1 py.method]
          display_gui_message: [1×1 py.method]
         get_part_annotations: [1×1 py.method]
               add_debug_text: [1×1 py.method]
           add_debug_cylinder: [1×1 py.method]
              get_annotations: [1×1 py.method]
                spawn_vehicle: [1×1 py.method]
                     vehicles: [1×1 py.beamngpy.api.beamng.vehicles.VehiclesApi]
            remove_step_limit: [1×1 py.method]
               change_setting: [1×1 py.method]
                    get_roads: [1×1 py.method]
         get_current_scenario: [1×1 py.method]
                      set_tod: [1×1 py.method]
                reset_traffic: [1×1 py.method]
             restart_scenario: [1×1 py.method]
            set_deterministic: [1×1 py.method]
                   get_levels: [1×1 py.method]

    &lt;beamngpy.beamng.beamng.BeamNGpy object at 0x00000168FA02F0D0&gt;
</div></div></div></div></div><div class="inlineWrapper"><div  class = 'S6'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% Add scenario information; name and level</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >scenario = py.beamngpy.Scenario(</span><span style="color: #a709f5;">'west_coast_usa'</span><span >, </span><span style="color: #a709f5;">'example'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% Add vehicle's information; name plate no. and vehicle model </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >vehicle = py.beamngpy.Vehicle(</span><span style="color: #a709f5;">'ego_vehicle'</span><span >, model=</span><span style="color: #a709f5;">'etk800'</span><span >, licence=</span><span style="color: #a709f5;">'MATLAB'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% specify the veicle's starting position </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >scenario.add_vehicle(vehicle, pos=[-717, 101, 118], </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    rot_quat=[0, 0, 0.3826834, 0.9238795]);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% save all data and load the scenario </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >scenario.make(beamng);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% waiting for the loaing process</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >pause(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% load the vehicle, level, and scensors in scenario </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.load_scenario(scenario);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.set_steps_per_second(60);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.set_deterministic();</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >pause(2);</span></span></div></div></div><h2  class = 'S1'><span>Run simulation</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S2'><span style="white-space: pre"><span style="color: #008013;">% start the scenario </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.start_scenario();</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >pause(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% adding initial throttle and strearing angle </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >vehicle.control(throttle=1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >vehicle.control(steering=0.5);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% setup the AI driving mode </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >vehicle.ai_set_mode(</span><span style="color: #a709f5;">'span'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >lidar1 =  py.beamngpy.sensors.Lidar(</span><span style="color: #a709f5;">'lidar1'</span><span >, beamng, vehicle, </span><span style="color: #0e00ff;">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >    is_using_shared_memory=true, is_visualised=true);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >pause(3);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% LiDAR point cloud data (automatic polling)</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% parse lidar data in data object </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >data = lidar1.poll();</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >pause(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >                                </span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span style="color: #008013;">% Collect the data now that it has been computed.</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >beamng.step(3, wait=false);</span></span></div></div><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre"><span >pause(10);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >beamng.close();</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Lidar tour
%% Scenario setup

% link bng object to BeamNG folder 
beamng = py.beamngpy.BeamNGpy('localhost', int32(25252)); %if you set the BNG_HOME in your Environment Variables
% beamng = BeamNGpy('localhost', 25252, home='/path/to/bng/tech', user='/path/to/bng/tech/userfolder')

% beamng.open(listen_ip='*');  % Start up the simulator in default renderer i.e., Vulkan.

beamng.open(py.list({string(missing),'Value'}), ...
    '-gfx', 'dx11', listen_ip='*') % Start up the simulator in DirectX 11 Renderer .

% Add scenario information; name and level
scenario = py.beamngpy.Scenario('west_coast_usa', 'example');
% Add vehicle's information; name plate no. and vehicle model 
vehicle = py.beamngpy.Vehicle('ego_vehicle', model='etk800', licence='MATLAB');
% specify the veicle's starting position 
scenario.add_vehicle(vehicle, pos=[-717, 101, 118], ...
    rot_quat=[0, 0, 0.3826834, 0.9238795]);
% save all data and load the scenario 
scenario.make(beamng);
% waiting for the loaing process
pause(2);
% load the vehicle, level, and scensors in scenario 
beamng.load_scenario(scenario);
beamng.set_steps_per_second(60);
beamng.set_deterministic();
pause(2);
%% Run simulation

% start the scenario 
beamng.start_scenario();
pause(2);

% adding initial throttle and strearing angle 
vehicle.control(throttle=1);
vehicle.control(steering=0.5);
% setup the AI driving mode 
vehicle.ai_set_mode('span');
lidar1 =  py.beamngpy.sensors.Lidar('lidar1', beamng, vehicle, ...
    is_using_shared_memory=true, is_visualised=true);
pause(3);

% LiDAR point cloud data (automatic polling)
% parse lidar data in data object 
data = lidar1.poll();

pause(1);
                                
% Collect the data now that it has been computed.
beamng.step(3, wait=false);
pause(10);
beamng.close();
##### SOURCE END #####
-->
</div></body></html>